============================= test session starts ==============================
platform darwin -- Python 3.12.2, pytest-8.3.2, pluggy-1.5.0 -- deltadb/.venv/bin/python
cachedir: .pytest_cache
rootdir: deltadb
configfile: pyproject.toml
collecting ... collected 2 items

tests/test_comparision.py::test_delta[2000-2000] PASSED                  [ 50%]
tests/test_comparision.py::test_sql[2000-2000] FAILED                    [100%]

=================================== FAILURES ===================================
_____________________________ test_sql[2000-2000] ______________________________

conn = <sqlite3.Connection object at 0x152fe6110>
testing_data = [{'field_0': '0', 'field_1': '1', 'field_10': '10', 'field_100': '100', ...}, {'field_0': '0', 'field_1': '1', 'field_..._10': '10', 'field_100': '100', ...}, {'field_0': '0', 'field_1': '1', 'field_10': '10', 'field_100': '100', ...}, ...]
height = 2000, width = 2000

    def test_sql(conn, testing_data, height, width):
        cursor = conn.cursor()
    
        first_row = testing_data[0]
        columns = ", ".join([f"{key} TEXT" for key in first_row.keys()])
    
        create_table_query = f"CREATE TABLE IF NOT EXISTS test_table ({columns})"
>       cursor.execute(create_table_query)
E       sqlite3.OperationalError: too many columns on test_table

tests/test_comparision.py:40: OperationalError
============================== slowest durations ===============================
0.62s setup    tests/test_comparision.py::test_sql[2000-2000]
0.60s setup    tests/test_comparision.py::test_delta[2000-2000]
0.59s call     tests/test_comparision.py::test_delta[2000-2000]
0.00s call     tests/test_comparision.py::test_sql[2000-2000]
0.00s teardown tests/test_comparision.py::test_delta[2000-2000]
0.00s teardown tests/test_comparision.py::test_sql[2000-2000]
=========================== short test summary info ============================
FAILED tests/test_comparision.py::test_sql[2000-2000] - sqlite3.OperationalError: too many columns on test_table
========================= 1 failed, 1 passed in 1.91s ==========================
